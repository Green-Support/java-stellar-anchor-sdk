fullName: anchor-platform
service:
   containerPort: 8080
   servicePort: 8080
   type: NodePort
   name: sep
image: 
   repo: stellar
   name: anchor-platform
   tag: latest
   pullPolicy: Always
deployment:
   replicas: 1
   startupProbePeriodSeconds: 10
   startupProbeFailureThreshold: 30
   serviceAccountName: default
   volumeMounts:
      secrets: SA2N44T5PKJ434T6WTAGJIGNER463IA7OUWPDQ5TBTWSKYJAK2UAGBCK
         - name: apsigningseed
           mountPath: signingseed 
      configMaps: # TODO: add your config maps here:
         - name: assets
           mountPath: assets
   hosts:
     - host: "paygod.godstabernacle.xyz"
       path: /
       pathType: Prefix
       backend:
         servicePort: "{{ .Values.service.containerPort }}"
         serviceName: "{{ .Values.fullName }}-svc-{{ .Values.service.name }}"
   annotations:
        prometheus.io/path: /actuator/prometheus
        prometheus.io/port: "8082"
        prometheus.io/scrape: "true"
   # Everything under envVars will be injected/propagated into the deployments.
   envVars:
      env:
      - name: STELLAR_ANCHOR_CONFIG
        value: file:/config/anchor-config.yaml
      envFrom:
      - secretRef:
          name: anchor-platform-secrets
      - configMapRef:
          name: "{{ .Values.fullName }}-config-env-vars"  # TODO: remember to rename this
ingress:
   labels:
     app: <appy>
     test: <label_test>
   annotations:
     kubernetes.io/ingress.class: "public"
     cert-manager.io/cluster-issuer: "default"
     ingress.kubernetes.io/ssl-redirect: "true"
     ingress.kubernetes.io/browser-xss-filter: "true"
     ingress.kubernetes.io/frame-deny: "true"
     ingress.kubernetes.io/content-type-nosniff: "true"
     ingress.kubernetes.io/hsts-max-age: "31536000"
     ingress.kubernetes.io/hsts-include-subdomains: "true"
   tls:
     host: "paygod.godstabernacle.xyz"
     secretName: <name-of-your-cert-secret>
   rules:
      hosts:
        - host: "paygod.godstabernacle.xyz"
          path: /
          pathType: Prefix
          backend:
            servicePort: "{{ .Values.service.containerPort }}"
            serviceName: "{{ .Values.fullName }}-svc-{{ .Values.service.name }}"
#
# If you want to have a dedicated stellar-observer service, you need to
# uncomment the `stellarObserver` section below.
#
# Attention! If you use the stellar observer as a separate service – by setting
# `stellarObserver.enabled` flag to `true` – you must use a shared database that
# will be accessible by both deployments (sep-server and stellar-observer).
# In-memory databases won't work.
 stellarObserver:
    enabled: true
    deployment:
       port: 8083
       probePath: "/health"
       probePeriodSeconds: 15
       initialDelaySeconds: 60
       startupProbeFailureThreshold: 10
       livenessProbeFailureThreshold: 2
     ingress:
       tls:
          host: "<observer.paygod.godstabernacle.xyz"    
       rules:
          hosts:
          - host: "<observer.paygod.godstabernacle.xyz" 
            path: /
            pathType: Prefix

# The following configurations (`app_config`, `toml_config`, and `assets_config`)
# will be used to configure the app(s) (both sep-server and stellar-observer).
app_config:
  version: 1
  #
  # Database (h2):
  data.type: h2
  #
  # Database (PostgreSQL):
  # data.type: postgres
  # data.url: jdbc:postgresql://<host>:<port>/<database_name>
  # data.username: POSTGRES_USERNAME  # TODO: use secrets
  # data.password: POSTGRES_PASSWORD  # TODO: use secrets
  # data.initial_connection_pool_size: 3
  # data.max_active_connections: 10
  # data.flyway_enabled: true
  # data.ddl_auto: update
  # data.flyway_location: /db/migration
  #
  host_url: https://paygod.godstabernacle.xyz
  stellar_network.network: TESTNET
  stellar_network.network_passphrase: Test SDF Network ; September 2015
  stellar_network.horizon_url: https://horizon-testnet.stellar.org
  callback_api.base_url: https://paygod.godstabernacle.xyz
  callback_api.auth.type: JWT
  platform_api.auth.type: JWT
  payment_observer.enabled: true
  languages: en
  sep1.enabled: true
  # `sep1.toml.value` is being set by the helm chart from `toml_config`.
  sep10.enabled: true
  sep10.home_domain: paygod.godstabernacle.xyz
  sep12.enabled: true
  sep24.enabled: false
  sep31.enabled: true
  sep31.payment_type: STRICT_SEND
  sep31.deposit_info_generator_type: api
  sep38.enabled: true
  metrics.enabled: true
  metrics.extras_enabled: true
  metrics.run_interval: 30
  # Events (kafka):
  events.enabled: true
  events.event_type_to_queue.quote_created: preview-id_ap_event_quote_created
  events.event_type_to_queue.transaction_created: preview-id_ap_event_transaction_created
  events.event_type_to_queue.transaction_status_changed: preview-id_ap_event_transaction_status_changed
  events.event_type_to_queue.transaction_error: preview-id_ap_event_transaction_error
  events.publisher.type: kafka
  events.publisher.kafka.bootstrap_server: localhost:29092
  events.publisher.kafka.client_id:
  events.publisher.kafka.retries: 1
  events.publisher.kafka.linger_ms: 1000
  events.publisher.kafka.batch_size: 10
  assets.type: json
  # `assets.value` is being set by the helm chart from `assets_config`.

toml_config: |
  ACCOUNTS = ["GAIXTJGANTERAERDZN72GJTAU4YYEFH2HZNKDDBWQKFY7W6LC4WLLVHV"]
  VERSION = "0.1.0"
  NETWORK_PASSPHRASE = "Test SDF Network ; September 2015"
  SIGNING_KEY = "GCJIKEKFS5YQP6OE7E6AALGD53NKFOHO6G7TGSMAB4X264SIFDOIVHP5"
  WEB_AUTH_ENDPOINT = "https://paygod.godstabernacle.xyz/auth"
  KYC_SERVER = "https://paygod.godstabernacle.xyz/sep12"
  DIRECT_PAYMENT_SERVER = "https://paygod.godstabernacle.xyz/sep31"
  ANCHOR_QUOTE_SERVER = "https://paygod.godstabernacle.xyz//sep38"
  
  [[CURRENCIES]]
  code = "NATUREUSD"
  issuer = "GA3BJUBNOIHANBJEKZFSQTCRB5CUQ4GSENQHVC5QNZGGSK3ILAZS6ATK"
  status = "test"
  is_asset_anchored = true
  anchor_asset_type = "fiat"
  desc = "A test NATUREUSD issued by GT."
  
  [DOCUMENTATION]
  ORG_NAME = "GT"
  ORG_URL = "https://godstabernacle.xyz"
  ORG_DESCRIPTION = "Recreo, Replete Terram"
  ORG_SUPPORT_EMAIL="support@godstabernacle.xyz"

assets_config: |
  {
    "assets": [
      {
        "schema": "stellar",
        "code": "NATUREUSD",
        "issuer": "GA3BJUBNOIHANBJEKZFSQTCRB5CUQ4GSENQHVC5QNZGGSK3ILAZS6ATK",
        "distribution_account": "GAIXTJGANTERAERDZN72GJTAU4YYEFH2HZNKDDBWQKFY7W6LC4WLLVHV",
        "significant_decimals": 4,
        "deposit" : {
          "enabled": true,
          "fee_minimum": 0,
          "fee_percent": 1,
          "min_amount": 1,
          "max_amount": 10000
        },
        "withdraw": {
          "enabled": true,
          "fee_fixed": 0,
          "fee_percent": 1,
          "min_amount": 1,
          "max_amount": 10000
        },
        "send": {
          "fee_fixed": 0,
          "fee_percent": 1,
          "min_amount": 1,
          "max_amount": 10000
        }
      }
    ]
  }

